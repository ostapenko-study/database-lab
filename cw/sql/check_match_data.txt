CREATE FUNCTION check_valid_data_match_schedule()
RETURNS trigger AS
$BODY$
DECLARE 
	t1 int;
	t2 int;
BEGIN
	SELECT tournaments.id INTO STRICT t1 from teams
	WHERE teams.id = NEW.teams_id_1; 
	SELECT tournaments.id INTO STRICT t2 from teams
	WHERE teams.id = NEW.teams_id_2; 
	
	IF t1=t2 AND t1=NEW.tournaments_id THEN
		RETURN NEW;
	ELSE
		RAISE EXCEPTION 'different tournaments id for team1, team2, match (% % %)', t1, t2, NEW.tournamnets_id;
	END IF;
END;
$BODY$
LANGUAGE plpgsql;



CREATE TRIGGER check_valid_data_match_schedule BEFORE INSERT OR UPDATE ON match_schedule
	FOR EACH ROW EXECUTE PROCEDURE check_valid_data_match_schedule();
